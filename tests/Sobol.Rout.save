
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###########################################################
> # Computation of Sensitivity Indexes (SI)
> # for the so-called Sobol function
> # via Polynomial Chaos Expansion (PCE)
> ###########################################################
> 
> 
> # Load of necessary functions
> library("polychaosbasics")
> 
> # nvx<-4 # Number of factors of interest
> nlhs<-200 # 20000
> degree<-5
> #############################################
> # Build Legendre polynomial
> #############################################
> set.seed(42)
> pce <- analyticsPolyLeg(nlhs, degree, 'sobol')
> # -----------------------------------------
> # Default display
> # -----------------------------------------
> print(pce)
Total number of monomials:  125 
Number of factors:  4 
Polynomial degree:  5 
Number of observations: 200 
> 
> # -----------------------------------------
> # Polynomial structure matrix
> # -----------------------------------------
> print(pce@design@.Data)
          Input 1 Input 2 Input 3 Input 4
0               0       0       0       0
4               0       0       0       1
3               0       0       1       0
2               0       1       0       0
1               1       0       0       0
4*4             0       0       0       2
3*4             0       0       1       1
3*3             0       0       2       0
2*4             0       1       0       1
2*3             0       1       1       0
2*2             0       2       0       0
1*4             1       0       0       1
1*3             1       0       1       0
1*2             1       1       0       0
1*1             2       0       0       0
4*4*4           0       0       0       3
3*4*4           0       0       1       2
3*3*4           0       0       2       1
3*3*3           0       0       3       0
2*4*4           0       1       0       2
2*3*4           0       1       1       1
2*3*3           0       1       2       0
2*2*4           0       2       0       1
2*2*3           0       2       1       0
2*2*2           0       3       0       0
1*4*4           1       0       0       2
1*3*4           1       0       1       1
1*3*3           1       0       2       0
1*2*4           1       1       0       1
1*2*3           1       1       1       0
1*2*2           1       2       0       0
1*1*4           2       0       0       1
1*1*3           2       0       1       0
1*1*2           2       1       0       0
1*1*1           3       0       0       0
4*4*4*4         0       0       0       4
3*4*4*4         0       0       1       3
3*3*4*4         0       0       2       2
3*3*3*4         0       0       3       1
3*3*3*3         0       0       4       0
2*4*4*4         0       1       0       3
2*3*4*4         0       1       1       2
2*3*3*4         0       1       2       1
2*3*3*3         0       1       3       0
2*2*4*4         0       2       0       2
2*2*3*4         0       2       1       1
2*2*3*3         0       2       2       0
2*2*2*4         0       3       0       1
2*2*2*3         0       3       1       0
2*2*2*2         0       4       0       0
1*4*4*4         1       0       0       3
1*3*4*4         1       0       1       2
1*3*3*4         1       0       2       1
1*3*3*3         1       0       3       0
1*2*4*4         1       1       0       2
1*2*3*4         1       1       1       1
1*2*3*3         1       1       2       0
1*2*2*4         1       2       0       1
1*2*2*3         1       2       1       0
1*2*2*2         1       3       0       0
1*1*4*4         2       0       0       2
1*1*3*4         2       0       1       1
1*1*3*3         2       0       2       0
1*1*2*4         2       1       0       1
1*1*2*3         2       1       1       0
1*1*2*2         2       2       0       0
1*1*1*4         3       0       0       1
1*1*1*3         3       0       1       0
1*1*1*2         3       1       0       0
1*1*1*1         4       0       0       0
4*4*4*4*4       0       0       0       5
3*4*4*4*4       0       0       1       4
3*3*4*4*4       0       0       2       3
3*3*3*4*4       0       0       3       2
3*3*3*3*4       0       0       4       1
3*3*3*3*3       0       0       5       0
2*4*4*4*4       0       1       0       4
2*3*4*4*4       0       1       1       3
2*3*3*4*4       0       1       2       2
2*3*3*3*4       0       1       3       1
2*3*3*3*3       0       1       4       0
2*2*4*4*4       0       2       0       3
2*2*3*4*4       0       2       1       2
2*2*3*3*4       0       2       2       1
2*2*3*3*3       0       2       3       0
2*2*2*4*4       0       3       0       2
2*2*2*3*4       0       3       1       1
2*2*2*3*3       0       3       2       0
2*2*2*2*4       0       4       0       1
2*2*2*2*3       0       4       1       0
2*2*2*2*2       0       5       0       0
1*4*4*4*4       1       0       0       4
1*3*4*4*4       1       0       1       3
1*3*3*4*4       1       0       2       2
1*3*3*3*4       1       0       3       1
1*3*3*3*3       1       0       4       0
1*2*4*4*4       1       1       0       3
1*2*3*4*4       1       1       1       2
1*2*3*3*4       1       1       2       1
1*2*3*3*3       1       1       3       0
1*2*2*4*4       1       2       0       2
1*2*2*3*4       1       2       1       1
1*2*2*3*3       1       2       2       0
1*2*2*2*4       1       3       0       1
1*2*2*2*3       1       3       1       0
1*2*2*2*2       1       4       0       0
1*1*4*4*4       2       0       0       3
1*1*3*4*4       2       0       1       2
1*1*3*3*4       2       0       2       1
1*1*3*3*3       2       0       3       0
1*1*2*4*4       2       1       0       2
1*1*2*3*4       2       1       1       1
1*1*2*3*3       2       1       2       0
1*1*2*2*4       2       2       0       1
1*1*2*2*3       2       2       1       0
1*1*2*2*2       2       3       0       0
1*1*1*4*4       3       0       0       2
1*1*1*3*4       3       0       1       1
1*1*1*3*3       3       0       2       0
1*1*1*2*4       3       1       0       1
1*1*1*2*3       3       1       1       0
1*1*1*2*2       3       2       0       0
1*1*1*1*4       4       0       0       1
1*1*1*1*3       4       0       1       0
1*1*1*1*2       4       1       0       0
1*1*1*1*1       5       0       0       0
> 
> #############################################
> # PCESI calculation
> #############################################
> retour <- PCESI(pce)
> 
> print(retour, all=TRUE)
PCE indexes:
            LE         PE        TPE
1 0.0006495675 0.54591963 0.59999253
2 0.0002748233 0.28115845 0.34313449
3 0.0020419881 0.06859035 0.11008532
4 0.0011841679 0.02210165 0.05402576

PCE indexes (percentages):
    %LE   %PE  %TPE
1 15.65 59.48 54.19
2  6.62 30.63 30.99
3 49.20  7.47  9.94
4 28.53  2.41  4.88

PCE fit:
       R2     RMSEP 
0.9933402 0.1188057 

Total number of monomials:  125 
Number of factors:  4 
Polynomial degree:  5 
Number of observations: 200 

Also included:
 * slot 'IMSI' (Individual Monomial Sensitivity Indexes). Length: 126
 * slot 'coef' (Regression coefficients). Length: 126
 * slot 'y.hat' (Metamodel output). Length: 200
 * slot 'call.PCEpoly' (Design creation command).
> 
> # -----------------------------------------
> # Individual Monomial SI
> # -----------------------------------------
> print(retour@IMSI)
           0            4            3            2            1          4*4 
0.000000e+00 1.184168e-03 2.041988e-03 2.748233e-04 6.495675e-04 1.773814e-02 
         3*4          3*3          2*4          2*3          2*2          1*4 
2.083200e-04 6.491047e-02 3.249763e-06 1.019984e-05 2.704686e-01 2.878498e-04 
         1*3          1*2          1*1        4*4*4        3*4*4        3*3*4 
5.087018e-05 5.380473e-04 5.159916e-01 1.486326e-03 1.862712e-03 1.213804e-04 
       3*3*3        2*4*4        2*3*4        2*3*3        2*2*4        2*2*3 
3.647831e-04 7.678280e-05 1.328049e-03 1.903570e-04 7.353547e-04 2.713417e-03 
       2*2*2        1*4*4        1*3*4        1*3*3        1*2*4        1*2*3 
5.926737e-05 5.712590e-04 1.121981e-03 1.569298e-03 7.409370e-05 4.876997e-04 
       1*2*2        1*1*4        1*1*3        1*1*2        1*1*1      4*4*4*4 
1.826406e-04 3.599988e-05 1.888349e-04 1.255027e-03 2.653573e-04 8.447951e-05 
     3*4*4*4      3*3*4*4      3*3*3*4      3*3*3*3      2*4*4*4      2*3*4*4 
6.744136e-05 3.191537e-05 8.828932e-05 9.975648e-04 3.932681e-05 1.427790e-04 
     2*3*3*4      2*3*3*3      2*2*4*4      2*2*3*4      2*2*3*3      2*2*2*4 
4.818122e-05 2.873362e-03 1.609002e-03 1.232587e-03 4.466519e-03 3.009485e-05 
     2*2*2*3      2*2*2*2      1*4*4*4      1*3*4*4      1*3*3*4      1*3*3*3 
7.757853e-04 1.007570e-02 7.913466e-04 1.301793e-03 3.434778e-04 2.448631e-07 
     1*2*4*4      1*2*3*4      1*2*3*3      1*2*2*4      1*2*2*3      1*2*2*2 
3.517295e-04 5.667813e-06 1.139625e-04 9.343441e-04 2.942262e-04 6.791220e-05 
     1*1*4*4      1*1*3*4      1*1*3*3      1*1*2*4      1*1*2*3      1*1*2*2 
2.396528e-03 1.285376e-08 6.736938e-04 6.414857e-05 4.431054e-03 2.099917e-02 
     1*1*1*4      1*1*1*3      1*1*1*2      1*1*1*1    4*4*4*4*4    3*4*4*4*4 
1.323949e-05 2.276101e-05 4.146978e-04 2.857862e-02 1.608535e-03 1.184764e-03 
   3*3*4*4*4    3*3*3*4*4    3*3*3*3*4    3*3*3*3*3    2*4*4*4*4    2*3*4*4*4 
4.630646e-05 1.737149e-07 6.800191e-04 2.755485e-04 6.653041e-04 4.842670e-05 
   2*3*3*4*4    2*3*3*3*4    2*3*3*3*3    2*2*4*4*4    2*2*3*4*4    2*2*3*3*4 
2.101722e-04 2.147624e-03 4.056396e-04 1.092862e-03 8.478468e-04 5.460144e-05 
   2*2*3*3*3    2*2*2*4*4    2*2*2*3*4    2*2*2*3*3    2*2*2*2*4    2*2*2*2*3 
6.933306e-04 6.942981e-05 3.271217e-06 9.664200e-06 2.730877e-05 1.315167e-03 
   2*2*2*2*2    1*4*4*4*4    1*3*4*4*4    1*3*3*4*4    1*3*3*3*4    1*3*3*3*3 
2.800823e-04 8.745954e-05 5.650812e-04 4.120787e-08 7.700634e-04 7.523085e-06 
   1*2*4*4*4    1*2*3*4*4    1*2*3*3*4    1*2*3*3*3    1*2*2*4*4    1*2*2*3*4 
4.477231e-04 1.080279e-04 2.386312e-05 3.522953e-05 9.035285e-04 4.218327e-04 
   1*2*2*3*3    1*2*2*2*4    1*2*2*2*3    1*2*2*2*2    1*1*4*4*4    1*1*3*4*4 
2.047116e-05 4.371805e-05 1.209710e-03 2.457246e-04 3.248394e-04 2.387956e-04 
   1*1*3*3*4    1*1*3*3*3    1*1*2*4*4    1*1*2*3*4    1*1*2*3*3    1*1*2*2*4 
1.902484e-04 6.995552e-05 5.284330e-05 1.393909e-07 6.044265e-04 1.892260e-03 
   1*1*2*2*3    1*1*2*2*2    1*1*1*4*4    1*1*1*3*4    1*1*1*3*3    1*1*1*2*4 
2.470385e-08 1.126806e-03 1.754736e-03 7.535052e-04 8.870830e-05 6.157958e-05 
   1*1*1*2*3    1*1*1*2*2    1*1*1*1*4    1*1*1*1*3    1*1*1*1*2    1*1*1*1*1 
5.178034e-04 1.531197e-04 2.867757e-04 1.455642e-03 2.709029e-05 4.344412e-04 
> 
> # -----------------------------------------
> # Regression coefficients
> # -----------------------------------------
> print(retour@coef)
            0             4             3             2             1 
 0.9169228059 -0.0208975270  0.0274419430  0.0100673474 -0.0154774853 
          4*4           3*4           3*3           2*4           2*3 
 0.1038990232  0.0153734343  0.1987535037  0.0019011131  0.0035343080 
          2*2           1*4           1*3           1*2           1*1 
 0.4057101174 -0.0177718998 -0.0073360336  0.0239473922  0.5603750184 
        4*4*4         3*4*4         3*3*4         3*3*3         2*4*4 
-0.0354028573  0.0600330409 -0.0153308351  0.0175387486  0.0116475591 
        2*3*4         2*3*3         2*2*4         2*2*3         2*2*2 
-0.0733122348  0.0192506426 -0.0364399405  0.0732051019 -0.0070695068 
        1*4*4         1*3*4         1*3*3         1*2*4         1*2*3 
 0.0316286840  0.0600301972 -0.0539230911 -0.0157818974 -0.0404494860 
        1*2*2         1*1*4         1*1*3         1*1*2         1*1*1 
-0.0177691793  0.0080756724  0.0189338061  0.0464878530 -0.0149588005 
      4*4*4*4       3*4*4*4       3*3*4*4       3*3*3*4       3*3*3*3 
-0.0095216768 -0.0130960233  0.0101594421  0.0152834053 -0.0327196248 
      2*4*4*4       2*3*4*4       2*3*3*4       2*3*3*3       2*2*4*4 
-0.0100839087 -0.0317190637 -0.0165631778  0.0867890467  0.0680971626 
      2*2*3*4       2*2*3*3       2*2*2*4       2*2*2*3       2*2*2*2 
-0.0893119414  0.1175890782  0.0084338772 -0.0472507110 -0.1039861304 
      1*4*4*4       1*3*4*4       1*3*3*4       1*3*3*3       1*2*4*4 
-0.0421091938  0.0840312904 -0.0446144193  0.0007533030  0.0414830688 
      1*2*3*4       1*2*3*3       1*2*2*4       1*2*2*3       1*2*2*2 
-0.0080118840  0.0248660011 -0.0744617651 -0.0399121973 -0.0132854144 
      1*1*4*4       1*1*3*4       1*1*3*3       1*1*2*4       1*1*2*3 
 0.0854838333  0.0002662405  0.0495501113 -0.0193926948  0.1590038162 
      1*1*2*2       1*1*1*4       1*1*1*3       1*1*1*2       1*1*1*1 
 0.2439956045 -0.0059470131  0.0077339289  0.0296991141 -0.1751291117 
    4*4*4*4*4     3*4*4*4*4     3*3*4*4*4     3*3*3*4*4     3*3*3*3*4 
-0.0456820518  0.0641813708 -0.0146903747  0.0008687857  0.0473191124 
    3*3*3*3*3     2*4*4*4*4     2*3*4*4*4     2*3*3*4*4     2*3*3*3*4 
 0.0189072918  0.0472875922 -0.0217202914 -0.0461870510 -0.1292996899 
    2*3*3*3*3     2*2*4*4*4     2*2*3*4*4     2*2*3*3*4     2*2*3*3*3 
 0.0376436247 -0.0704475712  0.0934444766 -0.0227506148  0.0525214021 
    2*2*2*4*4     2*2*2*3*4     2*2*2*3*3     2*2*2*2*4     2*2*2*2*3 
 0.0167080500  0.0053900443 -0.0065577573 -0.0091380583  0.0699500939 
    2*2*2*2*2     1*4*4*4*4     1*3*4*4*4     1*3*3*4*4     1*3*3*3*4 
-0.0190622070 -0.0161872731  0.0619000133  0.0006611471  0.0736704988 
    1*3*3*3*3     1*2*4*4*4     1*2*3*4*4     1*2*3*3*4     1*2*3*3*3 
 0.0049118388  0.0557765797 -0.0437981734  0.0193747286  0.0148467229 
    1*2*2*4*4     1*2*2*3*4     1*2*2*3*3     1*2*2*2*4     1*2*2*2*3 
-0.0907019612 -0.0915447939 -0.0132086145  0.0188660242 -0.0998860267 
    1*2*2*2*2     1*1*4*4*4     1*1*3*4*4     1*1*3*3*4     1*1*3*3*3 
 0.0287453874  0.0350819277 -0.0488041555 -0.0457585993  0.0176837120 
    1*1*2*4*4     1*1*2*3*4     1*1*2*3*3     1*1*2*2*4     1*1*2*2*3 
-0.0212614835 -0.0016063405  0.0810657615  0.1389890386 -0.0005142849 
    1*1*2*2*2     1*1*1*4*4     1*1*1*3*4     1*1*1*3*3     1*1*1*2*4 
-0.0657595112  0.0869630937  0.0793550011 -0.0196850372 -0.0212163285 
    1*1*1*2*3     1*1*1*2*2     1*1*1*1*4     1*1*1*1*3     1*1*1*1*2 
 0.0620625840  0.0230712654 -0.0324402756  0.0697656982  0.0084852437 
    1*1*1*1*1 
-0.0237408267 
> 
> #############################################
> # Plot Y against Y.hat
> # and regression line
> #############################################
> y.hat <-retour@y.hat
> y.obs <- pce[, "Y"]
> reg <- lm(y.hat ~ y.obs)
> jpeg(file="Sobol.jpg")
>  plot(y.hat, y.obs,
+       xlab="metamodel output", ylab="computer model output",
+       main="Sobol test", sub="Scatter plot and regression line")
> lines(reg$fitted.values, y.obs)
>  dev.off()
null device 
          1 
> 
> 
> proc.time()
   user  system elapsed 
  2.749   0.181   2.931 
